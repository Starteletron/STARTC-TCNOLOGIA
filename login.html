<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Entrar ‚Ä¢ StarC Tecnologias</title>
  <style>
    :root{
      --bg:#0b1220;           /* fundo escuro elegante */
      --card:#111827;         /* card */
      --muted:#94a3b8;        /* texto secund√°rio */
      --text:#e5e7eb;         /* texto principal */
      --brand:#22c55e;        /* verde destaque */
      --brand-700:#16a34a;
      --danger:#ef4444;
      --border:#1f2937;
      --input:#0f172a;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,sans-serif;
      color:var(--text); background: radial-gradient(1200px 600px at 10% -10%, #1e293b 0%, transparent 60%), radial-gradient(900px 500px at 110% 10%, #0ea5e9 5%, transparent 55%), var(--bg);
      display:grid; place-items:center; padding:20px;
    }

    .wrap{
      width:100%; max-width:1024px; display:grid; grid-template-columns: 1.2fr 1fr; gap:26px;
      align-items:stretch;
    }
    @media (max-width: 900px){ .wrap{ grid-template-columns: 1fr; } }

    .hero{
      border:1px solid var(--border); border-radius:var(--radius); padding:32px; background:linear-gradient(145deg,#0b1220,#0a0f1a);
      position:relative; overflow:hidden; box-shadow:var(--shadow);
    }
    .hero .badge{
      display:inline-flex; align-items:center; gap:8px; font-size:12px; color:#cbd5e1; background:#0f172a; border:1px solid #1f2937; padding:6px 10px; border-radius:999px;
    }
    .hero h1{
      font-size:clamp(26px,4vw,38px); line-height:1.2; margin:16px 0 10px;
    }
    .hero p{ color:var(--muted); margin:0 0 22px; max-width:52ch }
    .hero .features{
      display:grid; grid-template-columns: repeat(2,minmax(0,1fr)); gap:10px; margin-top:16px;
    }
    .chip{
      border:1px solid #223049; background:#0d1322; color:#cbd5e1; font-size:13px; padding:10px 12px; border-radius:10px;
      display:flex; align-items:center; gap:8px;
    }
    .glow{
      position:absolute; inset:auto -30% -30% auto; width:480px; height:480px; border-radius:50%;
      background: radial-gradient(circle at 30% 30%, rgba(34,197,94,.25), transparent 60%);
      filter: blur(40px); pointer-events:none;
    }

    .card{
      border:1px solid var(--border); background:linear-gradient(180deg, #0e1626, #0a0f1a);
      border-radius:var(--radius); padding:28px; box-shadow:var(--shadow);
    }
    .brand{
      display:flex; align-items:center; gap:10px; margin-bottom:16px;
    }
    .brand svg{ width:28px; height:28px }
    .brand strong{ font-weight:700; letter-spacing:.2px; }

    .title{ font-size:22px; margin:8px 0 4px }
    .muted{ color:var(--muted); font-size:14px; margin:0 0 18px }

    .field{ display:grid; gap:8px; margin:12px 0 }
    label{ color:#cbd5e1; font-size:14px }
    input{
      width:100%; background:var(--input); border:1px solid var(--border); color:var(--text);
      padding:12px 14px; border-radius:10px; outline:none; transition:border-color .18s ease, box-shadow .18s ease;
    }
    input:focus{ border-color:#334155; box-shadow:0 0 0 3px rgba(51,65,85,.25) }
    .row{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin:6px 0 2px }
    .row small{ color:var(--muted) }
    .link{ color:#93c5fd; text-decoration:none; font-size:13px }
    .link:hover{ text-decoration:underline }

    .btn{
      width:100%; display:inline-flex; align-items:center; justify-content:center; gap:10px;
      background:var(--brand); color:#06250f; border:1px solid #1a2e22; font-weight:700; letter-spacing:.2px;
      padding:12px 16px; border-radius:12px; cursor:pointer; transition:filter .18s ease, transform .04s ease;
    }
    .btn:hover{ filter:brightness(1.08) }
    .btn:active{ transform:translateY(1px) }
    .btn[disabled]{ opacity:.6; cursor:not-allowed }

    .btn-ghost{
      width:100%; margin-top:10px; background:#0f172a; color:#cbd5e1; border:1px solid #1f2937;
    }

    .err, .ok{
      margin-top:12px; padding:10px 12px; font-size:14px; border-radius:10px; border:1px solid;
    }
    .err{ color:#fecaca; background:#2a0f14; border-color:#7f1d1d }
    .ok{ color:#bbf7d0; background:#0f2a19; border-color:#14532d }

    .divider{
      display:flex; align-items:center; gap:10px; margin:14px 0; color:#94a3b8; font-size:12px;
    }
    .divider::before,.divider::after{ content:""; height:1px; flex:1; background:#203147 }
    .foot{ margin-top:14px; text-align:center; color:#64748b; font-size:12px }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Lado esquerdo (marketing) -->
    <section class="hero">
      <span class="badge">üöÄ Acesso exclusivo ‚Ä¢ Assinantes</span>
      <h1>Entre para usar as <span style="color:#86efac">ferramentas</span> e <span style="color:#93c5fd">automa√ß√µes</span> da StarC</h1>
      <p>Ganhe tempo com processos inteligentes: NEYBOT, fluxos financeiros, automa√ß√µes de RH, cobran√ßa recorrente por WhatsApp e muito mais.</p>

      <div class="features">
        <div class="chip">‚öôÔ∏è NEYBOT ‚Äì Rob√¥s e RPA</div>
        <div class="chip">üìä An√°lises fiscais</div>
        <div class="chip">ü§ñ IA aplicada a rotinas</div>
        <div class="chip">üí¨ Cobran√ßas via WhatsApp</div>
      </div>
      <div class="glow"></div>
    </section>

    <!-- Lado direito (formul√°rio de login) -->
    <section class="card" aria-labelledby="title">
      <div class="brand">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0Z" stroke="#22c55e" stroke-width="1.2"/>
          <path d="M7 13.5 11 8l2.8 3.7L17 10l-2 6H7.8" stroke="#86efac" stroke-width="1.2" />
        </svg>
        <strong>StarC Tecnologias</strong>
      </div>

      <h2 id="title" class="title">Entrar</h2>
      <p class="muted">Acesse com seu e-mail e senha. Se n√£o tiver acesso, fale com o suporte.</p>

      <form id="formLogin" novalidate>
        <div class="field">
          <label for="email">E-mail</label>
          <input id="email" name="email" type="email" inputmode="email" autocomplete="username" placeholder="voce@empresa.com" required />
        </div>

        <div class="field">
          <label for="senha">Senha</label>
          <div style="position:relative">
            <input id="senha" name="senha" type="password" autocomplete="current-password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required />
            <button type="button" id="togglePass" aria-label="Mostrar senha" style="position:absolute;right:8px;top:50%;transform:translateY(-50%);background:transparent;border:0;color:#94a3b8;cursor:pointer">üëÅÔ∏è</button>
          </div>
        </div>

        <div class="row">
          <small>Ambiente seguro ‚Ä¢ token expira em 12h</small>
          <a class="link" href="contato.html">Precisa de acesso?</a>
        </div>

        <button id="btnLogin" class="btn" type="submit">Entrar</button>

        <div id="msg" role="status" aria-live="polite" style="min-height:14px"></div>

        <div class="divider">ou</div>

        <!-- Bot√£o ‚ÄúGoogle‚Äù opcional: seu backend deve autorizar o e-mail via /api/login-google -->
        <button id="btnGoogle" class="btn btn-ghost" type="button">Entrar com Google (e-mail autorizado)</button>

        <p class="foot">¬© 2025 StarC Tecnologias</p>
      </form>
    </section>
  </div>

  <script>
    // ======= CONFIGURE AQUI =======
    const API_URL = "https://startc.gestaodecontabilidad3.workers.dev"; // sua API (Worker)
    const REDIRECT_AFTER_LOGIN = "ferramentas.html"; // para onde enviar ap√≥s login
    // ===============================

    const $ = (sel)=>document.querySelector(sel);
    const form = $("#formLogin");
    const btnLogin = $("#btnLogin");
    const btnGoogle = $("#btnGoogle");
    const out = $("#msg");

    const setMsg = (text, type='err')=>{
      if(!text){ out.innerHTML=''; return; }
      const cls = (type==='ok')?'ok':'err';
      out.className = cls;
      out.textContent = text;
    };

    const callAPI = async (path, payload)=>{
      const res = await fetch(API_URL + path, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload || {})
      });
      // Mesmo quando o backend devolve status 200 com "error", retornamos o json para tratar a msg
      let data;
      try{ data = await res.json(); } catch{ data = {status:'error', msg:'Erro ao ler resposta'}; }
      return data;
    };

    // Mostrar/ocultar senha
    $("#togglePass").addEventListener("click", ()=>{
      const i = $("#senha");
      i.type = (i.type === "password") ? "text" : "password";
    });

    // Login por e-mail/senha
    form.addEventListener("submit", async (ev)=>{
      ev.preventDefault();
      setMsg('');
      const email = $("#email").value.trim().toLowerCase();
      const senha = $("#senha").value;

      if(!email || !senha){
        setMsg("Informe e-mail e senha.");
        return;
      }

      btnLogin.disabled = true;
      btnLogin.textContent = "Entrando‚Ä¶";

      try{
        const data = await callAPI("/api/login", { email, senha });
        if (data.status === "ok" && data.token){
          // Guarda sess√£o local
          localStorage.setItem("stc_token", data.token);
          localStorage.setItem("stc_user", JSON.stringify(data.user || {}));
          setMsg("Login realizado com sucesso.", "ok");
          // Redireciona
          window.location.href = REDIRECT_AFTER_LOGIN;
          return;
        }
        // Tratar erros padronizados do backend
        const msg = data && data.msg ? data.msg : "Falha no login.";
        setMsg(msg);
      }catch(err){
        setMsg("Erro ao conectar. Verifique sua Internet e tente novamente.");
      }finally{
        btnLogin.disabled = false;
        btnLogin.textContent = "Entrar";
      }
    });

    // Login ‚ÄúGoogle‚Äù (sem SDK): pede e-mail e chama /api/login-google (o backend valida se est√° autorizado)
    btnGoogle.addEventListener("click", async ()=>{
      setMsg('');
      const email = prompt("Digite seu e-mail Google autorizado:");
      if(!email) return;
      btnGoogle.disabled = true; btnGoogle.textContent = "Validando‚Ä¶";
      try{
        const data = await callAPI("/api/login-google", { email: String(email).trim().toLowerCase(), nome: "" });
        if (data.status === "ok" && data.token){
          localStorage.setItem("stc_token", data.token);
          localStorage.setItem("stc_user", JSON.stringify(data.user || {}));
          setMsg("Login realizado com sucesso.", "ok");
          window.location.href = REDIRECT_AFTER_LOGIN;
          return;
        }
        setMsg(data.msg || "Este e-mail n√£o est√° autorizado.");
      }catch(e){
        setMsg("Erro ao conectar. Tente novamente.");
      }finally{
        btnGoogle.disabled = false; btnGoogle.textContent = "Entrar com Google (e-mail autorizado)";
      }
    });

    // (Opcional) Ping visual para voc√™ saber que a API est√° no ar
    (async ()=>{
      try{
        const r = await fetch(API_URL + "/api/ping");
        if(r.ok){ /* ok silencioso */ }
      }catch{}
    })();
  </script>
</body>
</html>
